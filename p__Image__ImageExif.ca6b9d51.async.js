"use strict";(self.webpackChunkcollaboration=self.webpackChunkcollaboration||[]).push([[821],{67598:function(w,C,e){e.r(C);var L=e(9783),D=e.n(L),R=e(97857),m=e.n(R),K=e(5574),c=e.n(K),i=e(1930),j=e(88484),r=e(60219),o=e(52645),l=e(69753),d=e(11774),s=e(85322),y=e(52111),E=e(80854),q=e(9361),ee=e(45360),ae=e(42075),te=e(82922),p=e(71577),S=e(5402),ne=e(32983),oe=e(41872),se=e(33729),_e=e.n(se),ie=e(96486),f=e.n(ie),Z=e(50008),I=e.n(Z),O=e(67294),a=e(85893);function re(){var le=q.Z.useToken(),de=le.token,ue=ee.ZP.useMessage(),b=c()(ue,2),me=b[0],Ee=b[1],ve=(0,O.useState)({}),F=c()(ve,2),T=F[0],N=F[1],ce=(0,O.useState)(""),G=c()(ce,2),u=G[0],z=G[1],fe=(0,O.useState)({}),J=c()(fe,2),v=J[0],$=J[1],Me=(0,O.useState)(""),Y=c()(Me,2),U=Y[0],W=Y[1],Pe=(0,O.useState)(),H=c()(Pe,2),V=H[0],Q=H[1];(0,O.useEffect)(function(){if(!f().isEmpty(u)){var n=I().load(u),t=function(x){if(x==="thumbnail")return"continue";var h=n[x],P=function(A){if(h.hasOwnProperty(A)){var X=Z.piexif.TAGS[x][A].name,Be=h[A];N(function(k){return m()(m()({},k),{},D()({},X,m()(m()({},k[X]),{},{value:Be,tag:A,ifd:x})))})}};for(var B in h)P(B)};for(var M in n)var _=t(M)}},[u]);var Oe=function(){N({}),z(""),$({}),W(""),Q(void 0)},ge=function(t){Oe();var M=t.type==="image/jpeg";return M?(Q(t),i.P.getBase64(t).then(function(_){z(_)})):me.error((0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.format-error",values:{name:t.name}})),!1},xe=function(){var t={Exif:{},"0th":{},"1st":{},GPS:{},Interop:{}};Object.keys(T).forEach(function(_){var g=T[_],x=g.tag,h=g.ifd,P=g.value;if(v.hasOwnProperty(_)){var B=v[_];if(isNaN(P))try{P=JSON.parse(B)}catch(he){P=B}else P=Number(B)}t[h][x]=P});var M=I().dump(t);W(I().insert(M,u))},De=function(){W(I().remove(u))},je=function(){if(V){var t=i.P.getFileName(V.name),M=t.name,_=t.ext;_e()(U,"".concat(M,"-copy.").concat(_),"image/jpeg")}};return(0,a.jsx)(d._z,{children:(0,a.jsxs)(s.Z,{split:"horizontal",direction:"column",children:[(0,a.jsxs)(s.Z,{split:"horizontal",children:[(0,a.jsx)(s.Z,{direction:"row",children:(0,a.jsxs)(ae.Z,{children:[(0,a.jsxs)(a.Fragment,{children:[Ee,(0,a.jsx)(te.Z,{beforeUpload:ge,accept:"image/jpeg",multiple:!1,showUploadList:!1,maxCount:1,children:(0,a.jsxs)(p.ZP,{icon:(0,a.jsx)(j.Z,{}),children:["",(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.upload"})]})})]}),(0,a.jsxs)(p.ZP,{disabled:f().isEmpty(v),onClick:xe,icon:(0,a.jsx)(r.Z,{}),children:["",(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.write"})]}),(0,a.jsxs)(p.ZP,{disabled:f().isEmpty(u),onClick:De,icon:(0,a.jsx)(o.Z,{}),children:["",(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.clear"})]}),(0,a.jsxs)(p.ZP,{disabled:f().isEmpty(U),onClick:je,icon:(0,a.jsx)(l.Z,{}),children:["",(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.save"})]})]})}),!f().isEmpty(u)&&(0,a.jsxs)(s.Z,{split:"vertical",children:[f().isEmpty(u)?null:(0,a.jsx)(s.Z,{colSpan:12,direction:"column",title:(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.original"}),children:(0,a.jsx)(S.Z,{src:u,height:300})}),f().isEmpty(U)?null:(0,a.jsx)(s.Z,{colSpan:12,direction:"column",title:(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.target"}),children:(0,a.jsx)(S.Z,{src:U,height:300})})]})]}),(0,a.jsx)(s.Z,{title:(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.title"}),tooltip:(0,a.jsx)(E.FormattedMessage,{id:"page.image.exif.tooltip"}),children:f().isEmpty(u)?(0,a.jsx)(ne.Z,{}):(0,a.jsx)(y.vY,{column:2,children:Object.keys(T).map(function(n){var t=T[n].value;return Array.isArray(t)&&(t=JSON.stringify(t)),(0,a.jsx)(y.vY.Item,{label:n,children:(0,a.jsx)(oe.Z.Text,{style:{marginLeft:de.margin,flex:1},editable:{text:(v==null?void 0:v[n])||t,onChange:function(_){$(function(g){return m()(m()({},g),{},D()({},n,_))})}},children:(v==null?void 0:v[n])||t})},n)})})})]})})}C.default=re},1930:function(w,C,e){e.d(C,{q:function(){return K},P:function(){return c}});var L=e(12444),D=e.n(L),R=e(72004),m=e.n(R),K=function(){function i(){D()(this,i)}return m()(i,null,[{key:"convertToBytes",value:function(r,o){var l=["B","kB","MB","GB","TB"],d=l.indexOf(o);return r*Math.pow(1024,d)}},{key:"convertFromBytes",value:function(r){var o=["B","kB","MB","GB","TB"],l=Math.floor(Math.log(r)/Math.log(1024)),d=o[l],s=r/Math.pow(1024,l);return"".concat(s.toFixed(2)," ").concat(d)}}]),i}(),c=function(){function i(){D()(this,i)}return m()(i,null,[{key:"getBase64",value:function(r){return new Promise(function(o,l){var d=new FileReader;d.readAsDataURL(r),d.onload=function(){return o(d.result)},d.onerror=function(s){return l(s)}})}},{key:"getFileName",value:function(r){var o=r.split("."),l=o.pop()||"";return o=o.join(),{name:o,ext:l}}}]),i}()}}]);
