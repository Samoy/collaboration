"use strict";(self.webpackChunkcollaboration=self.webpackChunkcollaboration||[]).push([[821],{67598:function(k,B,e){e.r(B);var A=e(9783),x=e.n(A),L=e(97857),E=e.n(L),R=e(5574),f=e.n(R),m=e(90930),_=e(67286),l=e(38410),s=e(50008),o=e.n(s),d=e(9361),D=e(2453),W=e(19151),w=e(42075),p=e(71577),S=e(47588),q=e(32983),ee=e(34056),g=e(67294),te=e(96486),P=e.n(te),ae=e(33729),ne=e.n(ae),v=e(80854),se=e(88484),oe=e(60219),ie=e(52645),_e=e(69753),Z=e(1930),t=e(85893);function le(){var re=d.Z.useToken(),de=re.token,ue=D.ZP.useMessage(),y=f()(ue,2),Ee=y[0],me=y[1],ve=(0,g.useState)({}),F=f()(ve,2),I=F[0],b=F[1],ce=(0,g.useState)(""),N=f()(ce,2),u=N[0],G=N[1],fe=(0,g.useState)({}),z=f()(fe,2),c=z[0],J=z[1],Pe=(0,g.useState)(""),$=f()(Pe,2),T=$[0],K=$[1],Me=(0,g.useState)(),Y=f()(Me,2),H=Y[0],V=Y[1];(0,g.useEffect)(function(){if(!P().isEmpty(u)){var n=o().load(u),a=function(j){if(j==="thumbnail")return"continue";var h=n[j],M=function(U){if(h.hasOwnProperty(U)){var Q=s.piexif.TAGS[j][U].name,Be=h[U];b(function(X){return E()(E()({},X),{},x()({},Q,E()(E()({},X[Q]),{},{value:Be,tag:U,ifd:j})))})}};for(var C in h)M(C)};for(var i in n)var r=a(i)}},[u]);var ge=function(){b({}),G(""),J({}),K(""),V(void 0)},Oe=function(a){var i=a.type==="image/jpeg";return i||Ee.error((0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.format-error",values:{name:a.name}})),ge(),i||W.Z.LIST_IGNORE},je=function(a){var i=a.file;V(i.originFileObj),Z.P.getBase64(i.originFileObj).then(function(r){G(r)})},xe=function(){var a={Exif:{},"0th":{},"1st":{},GPS:{},Interop:{}};Object.keys(I).forEach(function(r){var O=I[r],j=O.tag,h=O.ifd,M=O.value;if(c.hasOwnProperty(r)){var C=c[r];if(isNaN(M))try{M=JSON.parse(C)}catch(Ce){M=C}else M=Number(C)}a[h][j]=M});var i=o().dump(a);K(o().insert(i,u))},De=function(){K(o().remove(u))},he=function(){if(H){var a=Z.P.getFileName(H.name),i=a.name,r=a.ext;ne()(T,"".concat(i,"-copy.").concat(r),"image/jpeg")}};return(0,t.jsx)(m._z,{children:(0,t.jsxs)(_.Z,{split:"horizontal",direction:"column",children:[(0,t.jsxs)(_.Z,{split:"horizontal",children:[(0,t.jsx)(_.Z,{direction:"row",children:(0,t.jsxs)(w.Z,{children:[(0,t.jsxs)(t.Fragment,{children:[me,(0,t.jsx)(W.Z,{beforeUpload:Oe,accept:"image/jpeg",multiple:!1,showUploadList:!1,maxCount:1,onChange:je,children:(0,t.jsxs)(p.ZP,{icon:(0,t.jsx)(se.Z,{}),children:["",(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.upload"})]})})]}),(0,t.jsxs)(p.ZP,{disabled:P().isEmpty(c),onClick:xe,icon:(0,t.jsx)(oe.Z,{}),children:["",(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.write"})]}),(0,t.jsxs)(p.ZP,{disabled:P().isEmpty(u),onClick:De,icon:(0,t.jsx)(ie.Z,{}),children:["",(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.clear"})]}),(0,t.jsxs)(p.ZP,{disabled:P().isEmpty(T),onClick:he,icon:(0,t.jsx)(_e.Z,{}),children:["",(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.save"})]})]})}),!P().isEmpty(u)&&(0,t.jsxs)(_.Z,{split:"vertical",children:[P().isEmpty(u)?null:(0,t.jsx)(_.Z,{colSpan:12,direction:"column",title:(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.original"}),children:(0,t.jsx)(S.Z,{src:u,height:300})}),P().isEmpty(T)?null:(0,t.jsx)(_.Z,{colSpan:12,direction:"column",title:(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.target"}),children:(0,t.jsx)(S.Z,{src:T,height:300})})]})]}),(0,t.jsx)(_.Z,{title:(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.title"}),tooltip:(0,t.jsx)(v.FormattedMessage,{id:"page.image.exif.tooltip"}),children:P().isEmpty(u)?(0,t.jsx)(q.Z,{}):(0,t.jsx)(l.vY,{column:2,children:Object.keys(I).map(function(n){var a=I[n].value;return Array.isArray(a)&&(a=JSON.stringify(a)),(0,t.jsx)(l.vY.Item,{label:n,children:(0,t.jsx)(ee.Z.Text,{style:{marginLeft:de.margin,flex:1},editable:{text:(c==null?void 0:c[n])||a,onChange:function(r){J(function(O){return E()(E()({},O),{},x()({},n,r))})}},children:(c==null?void 0:c[n])||a})},n)})})})]})})}B.default=le},1930:function(k,B,e){e.d(B,{q:function(){return R},P:function(){return f}});var A=e(12444),x=e.n(A),L=e(72004),E=e.n(L),R=function(){function m(){x()(this,m)}return E()(m,null,[{key:"convertToBytes",value:function(l,s){var o=["B","kB","MB","GB","TB"],d=o.indexOf(s);return l*Math.pow(1024,d)}},{key:"convertFromBytes",value:function(l){var s=["B","kB","MB","GB","TB"],o=Math.floor(Math.log(l)/Math.log(1024)),d=s[o],D=l/Math.pow(1024,o);return"".concat(D.toFixed(2)," ").concat(d)}}]),m}(),f=function(){function m(){x()(this,m)}return E()(m,null,[{key:"getBase64",value:function(l){return new Promise(function(s,o){var d=new FileReader;d.readAsDataURL(l),d.onload=function(){return s(d.result)},d.onerror=function(D){return o(D)}})}},{key:"getFileName",value:function(l){var s=l.split("."),o=s.pop()||"";return s=s.join(),{name:s,ext:o}}}]),m}()}}]);
